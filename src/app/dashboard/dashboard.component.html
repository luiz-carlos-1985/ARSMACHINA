<div class="dashboard-wrapper">
  <!-- Hero Section -->
  <div class="dashboard-hero">
    <div class="hero-content">
      <div class="hero-text">
        <h1>Olá, <span class="user-highlight">{{ userName }}</span>! 👋</h1>
        <p class="hero-subtitle">{{ getTranslation('dashboard.welcome') }}</p>
        <div class="hero-actions">
          <button class="hero-action-btn primary" (click)="createNewProject()">
            <span class="btn-icon">➕</span>
            {{ getTranslation('dashboard.newProject') }}
          </button>
          <button class="hero-action-btn secondary" (click)="generateReport()">
            <span class="btn-icon">📊</span>
            {{ getTranslation('dashboard.generateReport') }}
          </button>
        </div>
      </div>
      <div class="hero-visual">
        <div class="hero-stats">
          <div class="stat-card">
            <div class="stat-icon">📊</div>
            <div class="stat-number">{{ userStats.projects }}</div>
            <div class="stat-label">{{ getTranslation('dashboard.projects') }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">✅</div>
            <div class="stat-number">{{ userStats.tasks }}</div>
            <div class="stat-label">{{ getTranslation('dashboard.tasks') }}</div>
          </div>
          <div class="stat-card">
            <div class="stat-icon">🎯</div>
            <div class="stat-number">{{ userStats.completed }}</div>
            <div class="stat-label">{{ getTranslation('dashboard.completed') }}</div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Quick Actions Bar -->
  <div class="quick-actions-bar">
    <div class="actions-container">
      <div class="action-button primary" (click)="createNewProject()">
        <div class="action-icon">➕</div>
        <div class="action-text">
          <div class="action-title">{{ getTranslation('dashboard.newProject') }}</div>
          <div class="action-subtitle">Criar um novo projeto</div>
        </div>
      </div>
      <div class="action-button secondary" (click)="addNewTask()">
        <div class="action-icon">📝</div>
        <div class="action-text">
          <div class="action-title">{{ getTranslation('dashboard.newTask') }}</div>
          <div class="action-subtitle">Adicionar nova tarefa</div>
        </div>
      </div>
      <div class="action-button info" (click)="scheduleMeeting()">
        <div class="action-icon">📅</div>
        <div class="action-text">
          <div class="action-title">{{ getTranslation('dashboard.scheduleMeeting') }}</div>
          <div class="action-subtitle">Agendar reunião</div>
        </div>
      </div>
      <div class="action-button success" (click)="generateReport()">
        <div class="action-icon">📊</div>
        <div class="action-text">
          <div class="action-title">{{ getTranslation('dashboard.generateReport') }}</div>
          <div class="action-subtitle">Gerar relatório</div>
        </div>
      </div>
    </div>
  </div>

  <!-- Main Dashboard Content -->
  <div class="dashboard-content">
    <div class="content-grid">
      <!-- Analytics Overview -->
      <div class="analytics-overview">
        <div class="section-header">
          <h2>{{ getTranslation('dashboard.analytics') }}</h2>
          <div class="section-actions">
            <button class="icon-btn" (click)="refreshAnalytics()" title="Atualizar">🔄</button>
            <button class="icon-btn" (click)="exportAnalytics()" title="Exportar">📤</button>
          </div>
        </div>
        <div class="analytics-grid">
          <div class="metric-card productivity">
            <div class="metric-header">
              <div class="metric-icon">⚡</div>
              <div class="metric-info">
                <h3>{{ getTranslation('dashboard.productivity') }}</h3>
              </div>
            </div>
            <div class="metric-value">{{ productivityScore }}%</div>
            <div class="metric-progress">
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="productivityScore"></div>
              </div>
            </div>
            <div class="progress-change positive">+12% {{ getTranslation('dashboard.fromLastMonth') }}</div>
          </div>
          <div class="metric-card performance">
            <div class="metric-header">
              <div class="metric-icon">👥</div>
              <div class="metric-info">
                <h3>{{ getTranslation('dashboard.teamPerformance') }}</h3>
              </div>
            </div>
            <div class="metric-value">{{ teamPerformance }}%</div>
            <div class="metric-progress">
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="teamPerformance"></div>
              </div>
            </div>
            <div class="progress-change positive">+8% {{ getTranslation('dashboard.fromLastMonth') }}</div>
          </div>
          <div class="metric-card satisfaction">
            <div class="metric-header">
              <div class="metric-icon">😊</div>
              <div class="metric-info">
                <h3>{{ getTranslation('dashboard.clientSatisfaction') }}</h3>
              </div>
            </div>
            <div class="metric-value">{{ clientSatisfaction }}%</div>
            <div class="metric-progress">
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="clientSatisfaction"></div>
              </div>
            </div>
            <div class="progress-change positive">+15% {{ getTranslation('dashboard.fromLastMonth') }}</div>
          </div>
          <div class="metric-card revenue">
            <div class="metric-header">
              <div class="metric-icon">💰</div>
              <div class="metric-info">
                <h3>{{ getTranslation('dashboard.revenue') }}</h3>
              </div>
            </div>
            <div class="metric-value">R$ {{ revenue | number:'1.0-0' }}</div>
            <div class="revenue-trend">
              <div class="trend-chart">
                <div class="trend-line" [style.height.%]="85"></div>
                <div class="trend-line" [style.height.%]="92"></div>
                <div class="trend-line" [style.height.%]="78"></div>
                <div class="trend-line" [style.height.%]="95"></div>
              </div>
              <div class="trend-change">+22% {{ getTranslation('dashboard.fromLastMonth') }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Projects Overview -->
      <div class="projects-overview">
        <div class="section-header">
          <h2>{{ getTranslation('dashboard.projectProgress') }}</h2>
          <button class="manage-projects-btn" (click)="manageProjects()">
            {{ getTranslation('dashboard.viewAll') }}
          </button>
        </div>
        <div class="projects-grid">
          <div class="project-card" *ngFor="let project of activeProjects">
            <div class="project-header">
              <div class="project-info">
                <h4>{{ project.name }}</h4>
                <div class="project-status" [ngClass]="project.status">{{ project.statusText }}</div>
              </div>
              <div class="project-menu">
                <button class="menu-btn" (click)="openProjectMenu(project)">⋮</button>
              </div>
            </div>
            <div class="project-progress">
              <div class="progress-info">
                <span class="progress-label">Progresso</span>
                <span class="progress-value">{{ project.progress }}%</span>
              </div>
              <div class="progress-bar">
                <div class="progress-fill" [style.width.%]="project.progress"></div>
              </div>
            </div>
            <div class="project-meta">
              <div class="meta-item">
                <span>📅</span>
                <span>{{ getTranslation('dashboard.due') }}: {{ project.deadline }}</span>
              </div>
              <div class="meta-item">
                <span>👥</span>
                <span>{{ project.teamSize }} {{ getTranslation('dashboard.members') }}</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Activity & Notifications -->
    <div class="activity-notifications">
      <!-- Recent Activities -->
      <div class="activities-panel">
        <div class="panel-header">
          <h3>{{ getTranslation('dashboard.recentActivity') }}</h3>
          <button class="view-all-btn" (click)="viewAllActivities()">
            {{ getTranslation('dashboard.viewActivity') }}
          </button>
        </div>
        <div class="activities-list">
          <div class="activity-item" *ngFor="let activity of recentActivities.slice(0, 5)">
            <div class="activity-icon">{{ getActivityIcon(activity.type) }}</div>
            <div class="activity-content">
              <div class="activity-text">{{ activity.text }}</div>
              <div class="activity-time">{{ activity.time }}</div>
            </div>
          </div>
        </div>
      </div>

      <!-- Notifications -->
      <div class="notifications-panel">
        <div class="panel-header">
          <h3>{{ getTranslation('dashboard.notifications') }}</h3>
          <div class="notification-count" *ngIf="unreadNotificationsCount > 0">
            {{ unreadNotificationsCount }}
          </div>
        </div>
        <div class="notifications-list">
          <div class="notification-item" 
               *ngFor="let notification of notifications.slice(0, 4)"
               [ngClass]="{ 'unread': !notification.read }">
            <div class="notification-icon">{{ getNotificationIcon(notification.type) }}</div>
            <div class="notification-content">
              <div class="notification-text">{{ notification.text }}</div>
              <div class="notification-time">{{ notification.time }}</div>
            </div>
            <button class="notification-close" 
                    (click)="dismissNotification(notification)"
                    [title]="getTranslation('dashboard.dismissNotification')">×</button>
          </div>
        </div>
        <button class="view-all-notifications" (click)="viewAllNotifications()">
          {{ getTranslation('dashboard.viewAll') }}
        </button>
      </div>
    </div>
  </div>

  <!-- Quick Links & Support -->
  <div class="quick-links-support">
    <!-- Quick Links -->
    <div class="quick-links-panel">
      <h3>{{ getTranslation('dashboard.quickLinks') }}</h3>
      <div class="links-grid">
        <a href="#" class="quick-link" (click)="navigateTo('profile')">
          <div class="link-icon">👤</div>
          <span>{{ getTranslation('dashboard.profile') }}</span>
        </a>
        <a href="#" class="quick-link" (click)="navigateTo('settings')">
          <div class="link-icon">⚙️</div>
          <span>{{ getTranslation('dashboard.settings') }}</span>
        </a>
        <a href="#" class="quick-link" (click)="navigateTo('reports')">
          <div class="link-icon">📊</div>
          <span>{{ getTranslation('dashboard.reports') }}</span>
        </a>
        <a href="#" class="quick-link" (click)="navigateTo('help')">
          <div class="link-icon">❓</div>
          <span>{{ getTranslation('dashboard.help') }}</span>
        </a>
      </div>
    </div>

    <!-- Support -->
    <div class="support-panel">
      <h3>Suporte</h3>
      <div class="support-options">
        <button class="support-btn chat" (click)="openChatSupport()">
          <div class="support-icon">💬</div>
          <div class="support-info">
            <div class="support-title">Chat ao Vivo</div>
            <div class="support-subtitle">Resposta imediata</div>
          </div>
        </button>
        <button class="support-btn email" (click)="sendSupportEmail()">
          <div class="support-icon">📧</div>
          <div class="support-info">
            <div class="support-title">Email</div>
            <div class="support-subtitle">Resposta em 24h</div>
          </div>
        </button>
        <button class="support-btn phone" (click)="callSupport()">
          <div class="support-icon">📞</div>
          <div class="support-info">
            <div class="support-title">Telefone</div>
            <div class="support-subtitle">+55 11 99999-9999</div>
          </div>
        </button>
      </div>
    </div>
  </div>
</div>

<!-- Project Management Modal -->
<div class="modal-overlay" *ngIf="showProjectModal" (click)="closeProjectModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ isEditingProject ? 'Editar Projeto' : 'Novo Projeto' }}</h3>
      <button class="modal-close" (click)="closeProjectModal()">×</button>
    </div>
    <div class="modal-body">
      <form (ngSubmit)="saveProject()" #projectForm="ngForm">
        <div class="form-group">
          <label for="projectName">Nome do Projeto</label>
          <input type="text" id="projectName" name="projectName" 
                 [(ngModel)]="currentProject.name" required>
        </div>
        <div class="form-group">
          <label for="projectDescription">Descrição</label>
          <textarea id="projectDescription" name="projectDescription" 
                    [(ngModel)]="currentProject.description" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label for="projectDeadline">Prazo</label>
          <input type="date" id="projectDeadline" name="projectDeadline" 
                 [(ngModel)]="currentProject.deadline" required>
        </div>
        <div class="form-group">
          <label for="projectTeamSize">Tamanho da Equipe</label>
          <input type="number" id="projectTeamSize" name="projectTeamSize" 
                 [(ngModel)]="currentProject.teamSize" min="1" required>
        </div>
        <div class="form-group">
          <label for="projectStatus">Status</label>
          <select id="projectStatus" name="projectStatus" 
                  [(ngModel)]="currentProject.status" required>
            <option value="planning">Planejamento</option>
            <option value="in-progress">Em Andamento</option>
            <option value="review">Em Revisão</option>
            <option value="completed">Concluído</option>
          </select>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="closeProjectModal()">
            Cancelar
          </button>
          <button type="submit" class="btn-primary" [disabled]="!projectForm.form.valid">
            {{ isEditingProject ? 'Atualizar' : 'Criar' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Task Management Modal -->
<div class="modal-overlay" *ngIf="showTaskModal" (click)="closeTaskModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h3>{{ isEditingTask ? 'Editar Tarefa' : 'Nova Tarefa' }}</h3>
      <button class="modal-close" (click)="closeTaskModal()">×</button>
    </div>
    <div class="modal-body">
      <form (ngSubmit)="saveTask()" #taskForm="ngForm">
        <div class="form-group">
          <label for="taskTitle">Título da Tarefa</label>
          <input type="text" id="taskTitle" name="taskTitle" 
                 [(ngModel)]="currentTask.title" required>
        </div>
        <div class="form-group">
          <label for="taskDescription">Descrição</label>
          <textarea id="taskDescription" name="taskDescription" 
                    [(ngModel)]="currentTask.description" rows="3"></textarea>
        </div>
        <div class="form-group">
          <label for="taskProject">Projeto</label>
          <select id="taskProject" name="taskProject" 
                  [(ngModel)]="currentTask.projectId" required>
            <option value="">Selecione um projeto</option>
            <option *ngFor="let project of activeProjects" [value]="project.id">
              {{ project.name }}
            </option>
          </select>
        </div>
        <div class="form-group">
          <label for="taskPriority">Prioridade</label>
          <select id="taskPriority" name="taskPriority" 
                  [(ngModel)]="currentTask.priority" required>
            <option value="low">Baixa</option>
            <option value="medium">Média</option>
            <option value="high">Alta</option>
            <option value="urgent">Urgente</option>
          </select>
        </div>
        <div class="form-group">
          <label for="taskDueDate">Data de Vencimento</label>
          <input type="date" id="taskDueDate" name="taskDueDate" 
                 [(ngModel)]="currentTask.dueDate" required>
        </div>
        <div class="modal-actions">
          <button type="button" class="btn-secondary" (click)="closeTaskModal()">
            Cancelar
          </button>
          <button type="submit" class="btn-primary" [disabled]="!taskForm.form.valid">
            {{ isEditingTask ? 'Atualizar' : 'Criar' }}
          </button>
        </div>
      </form>
    </div>
  </div>
</div>
