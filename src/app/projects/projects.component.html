<div class="projects-wrapper">
  <!-- Header -->
  <div class="projects-header">
    <div class="header-content">
      <button class="back-btn" (click)="goBack()">
        <span class="back-icon">←</span>
        Voltar ao Dashboard
      </button>
      <div class="header-info">
        <h1>Todos os Projetos</h1>
        <p>Gerencie e acompanhe todos os seus projetos em um só lugar</p>
      </div>
      <div class="header-actions">
        <button class="export-btn" (click)="exportProjects()">
          <span class="btn-icon">📤</span>
          Exportar
        </button>
      </div>
    </div>
  </div>

  <!-- Filters and Search -->
  <div class="filters-section">
    <div class="filters-container">
      <div class="search-box">
        <span class="search-icon">🔍</span>
        <input 
          type="text" 
          placeholder="Buscar projetos..." 
          [(ngModel)]="searchTerm" 
          (input)="onSearchChange()"
        >
      </div>
      
      <div class="filter-group">
        <label>Status:</label>
        <select [(ngModel)]="statusFilter" (change)="onStatusFilterChange()" title="Filtrar por status do projeto">
          <option value="all">Todos</option>
          <option value="planning">Planejamento</option>
          <option value="in-progress">Em Andamento</option>
          <option value="review">Em Revisão</option>
          <option value="completed">Concluído</option>
        </select>
      </div>

      <div class="filter-group">
        <label>Ordenar por:</label>
        <select [(ngModel)]="sortBy" (change)="onSortChange()" title="Ordenar projetos por critério">
          <option value="name">Nome</option>
          <option value="deadline">Prazo</option>
          <option value="progress">Progresso</option>
          <option value="priority">Prioridade</option>
          <option value="budget">Orçamento</option>
        </select>
      </div>

      <button class="sort-order-btn" (click)="toggleSortOrder()" [title]="sortOrder === 'asc' ? 'Crescente' : 'Decrescente'">
        <span class="sort-icon">{{ sortOrder === 'asc' ? '↑' : '↓' }}</span>
      </button>
    </div>
  </div>

  <!-- Projects Stats -->
  <div class="projects-stats">
    <div class="stat-card">
      <div class="stat-icon">📁</div>
      <div class="stat-info">
        <div class="stat-number">{{ filteredProjects.length }}</div>
        <div class="stat-label">Projetos Encontrados</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">⚡</div>
      <div class="stat-info">
        <div class="stat-number">{{ inProgressCount }}</div>
        <div class="stat-label">Em Andamento</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">✅</div>
      <div class="stat-info">
        <div class="stat-number">{{ completedCount }}</div>
        <div class="stat-label">Concluídos</div>
      </div>
    </div>
    <div class="stat-card">
      <div class="stat-icon">💰</div>
      <div class="stat-info">
        <div class="stat-number">R$ {{ totalBudgetFormatted }}K</div>
        <div class="stat-label">Orçamento Total</div>
      </div>
    </div>
  </div>

  <!-- Projects Grid -->
  <div class="projects-grid">
    <div class="project-card" *ngFor="let project of filteredProjects" [ngClass]="getStatusClass(project.status)">
      <!-- Project Header -->
      <div class="project-header">
        <div class="project-title">
          <h3>{{ project.name }}</h3>
          <div class="project-badges">
            <span class="status-badge" [ngClass]="getStatusClass(project.status)">
              {{ project.statusText }}
            </span>
            <span class="priority-badge" [ngClass]="getPriorityClass(project.priority)">
              {{ project.priority === 'high' ? 'Alta' : project.priority === 'medium' ? 'Média' : 'Baixa' }}
            </span>
          </div>
        </div>
        <div class="project-actions">
          <button class="action-btn view" (click)="viewProject(project)" title="Visualizar">
            👁️
          </button>
          <button class="action-btn edit" (click)="editProject(project)" title="Editar">
            ✏️
          </button>
          <button class="action-btn delete" (click)="deleteProject(project)" title="Excluir">
            🗑️
          </button>
        </div>
      </div>

      <!-- Project Info -->
      <div class="project-info">
        <p class="project-description">{{ project.description }}</p>
        
        <div class="project-details">
          <div class="detail-item">
            <span class="detail-icon">👤</span>
            <span class="detail-label">Cliente:</span>
            <span class="detail-value">{{ project.client }}</span>
          </div>
          <div class="detail-item">
            <span class="detail-icon">👥</span>
            <span class="detail-label">Equipe:</span>
            <span class="detail-value">{{ project.teamSize }} membros</span>
          </div>
          <div class="detail-item">
            <span class="detail-icon">📅</span>
            <span class="detail-label">Prazo:</span>
            <span class="detail-value" [ngClass]="'deadline-' + getDeadlineStatus(project.deadline)">
              {{ project.deadline }}
              <span class="days-remaining" *ngIf="getDaysUntilDeadline(project.deadline) >= 0">
                ({{ getDaysUntilDeadline(project.deadline) }} dias)
              </span>
              <span class="overdue" *ngIf="getDaysUntilDeadline(project.deadline) < 0">
                ({{ Math.abs(getDaysUntilDeadline(project.deadline)) }} dias atrasado)
              </span>
            </span>
          </div>
          <div class="detail-item">
            <span class="detail-icon">💰</span>
            <span class="detail-label">Orçamento:</span>
            <span class="detail-value">R$ {{ (project.budget || 0).toLocaleString('pt-BR') }}</span>
          </div>
        </div>
      </div>

      <!-- Progress Bar -->
      <div class="project-progress">
        <div class="progress-header">
          <span class="progress-label">Progresso</span>
          <span class="progress-value">{{ project.progress }}%</span>
        </div>
        <div class="progress-bar">
          <div class="progress-fill" [style.width.%]="project.progress" [ngClass]="getStatusClass(project.status)"></div>
        </div>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div class="empty-state" *ngIf="filteredProjects.length === 0">
    <div class="empty-icon">📂</div>
    <h3>Nenhum projeto encontrado</h3>
    <p>Tente ajustar os filtros ou termos de busca</p>
    <button class="clear-filters-btn" (click)="clearFilters()">
      Limpar Filtros
    </button>
  </div>
</div>