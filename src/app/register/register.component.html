<div class="register-container">
  <div class="register-form">
    <h2>{{ getTranslation('register.title') }}</h2>
    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="email">{{ getTranslation('register.email') }}:</label>
        <div class="input-container">
          <input
            type="email"
            id="email"
            formControlName="email"
            placeholder="seu@email.com"
            [class.valid]="email?.valid && email?.value"
            [class.invalid]="email?.invalid && email?.touched"
            [class.checking]="isEmailChecking"
          />
          <span class="input-icon checking" *ngIf="isEmailChecking">⏳</span>
          <span class="input-icon" *ngIf="email?.valid && email?.value && !isEmailChecking">✓</span>
          <span class="input-icon error" *ngIf="email?.invalid && email?.touched && !isEmailChecking">✗</span>
        </div>
        <div *ngIf="email?.touched && getFieldError('email')" class="error">
          {{ getFieldError('email') }}
        </div>
      </div>

      <div class="form-group">
        <label for="password">{{ getTranslation('register.password') }}:</label>
        <div class="input-container">
          <input
            [type]="showPassword ? 'text' : 'password'"
            id="password"
            formControlName="password"
            placeholder="Mínimo 8 caracteres"
            [class.valid]="password?.valid && password?.value"
            [class.invalid]="password?.invalid && password?.touched"
          />
          <button type="button" class="toggle-password" (click)="togglePasswordVisibility()">
            {{ showPassword ? '👁️' : '🙈' }}
          </button>
        </div>
        
        <!-- Password strength indicator -->
        <div class="password-strength" *ngIf="password?.value">
          <div class="strength-bar">
            <div class="strength-fill" [style.width.%]="passwordStrength" 
                 [class.weak]="passwordStrength < 40"
                 [class.medium]="passwordStrength >= 40 && passwordStrength < 80"
                 [class.strong]="passwordStrength >= 80"></div>
          </div>
          <span class="strength-text">{{ passwordStrengthText }}</span>
        </div>

        <!-- Password requirements checklist -->
        <ul class="password-requirements" *ngIf="password?.value">
          <li [class.met]="passwordRequirements.minLength">
            <span class="req-icon">{{ passwordRequirements.minLength ? '✓' : '✗' }}</span>
            Mínimo 8 caracteres
          </li>
          <li [class.met]="passwordRequirements.uppercase">
            <span class="req-icon">{{ passwordRequirements.uppercase ? '✓' : '✗' }}</span>
            Uma letra maiúscula
          </li>
          <li [class.met]="passwordRequirements.lowercase">
            <span class="req-icon">{{ passwordRequirements.lowercase ? '✓' : '✗' }}</span>
            Uma letra minúscula
          </li>
          <li [class.met]="passwordRequirements.number">
            <span class="req-icon">{{ passwordRequirements.number ? '✓' : '✗' }}</span>
            Um número
          </li>
          <li [class.met]="passwordRequirements.specialChar">
            <span class="req-icon">{{ passwordRequirements.specialChar ? '✓' : '✗' }}</span>
            Um caractere especial (!&#64;#$%^&*)
          </li>
        </ul>
      </div>

      <div class="form-group">
        <label for="confirmPassword">{{ getTranslation('register.confirmPassword') }}:</label>
        <div class="input-container">
          <input
            [type]="showConfirmPassword ? 'text' : 'password'"
            id="confirmPassword"
            formControlName="confirmPassword"
            placeholder="Confirme sua senha"
            [class.valid]="!registerForm.errors?.['passwordMismatch'] && confirmPassword?.value"
            [class.invalid]="(registerForm.errors?.['passwordMismatch'] || confirmPassword?.invalid) && confirmPassword?.touched"
          />
          <button type="button" class="toggle-password" (click)="toggleConfirmPasswordVisibility()">
            {{ showConfirmPassword ? '👁️' : '🙈' }}
          </button>
          <span class="input-icon" *ngIf="!registerForm.errors?.['passwordMismatch'] && confirmPassword?.value">✓</span>
          <span class="input-icon error" *ngIf="(registerForm.errors?.['passwordMismatch'] || confirmPassword?.invalid) && confirmPassword?.touched">✗</span>
        </div>
        <div *ngIf="confirmPassword?.touched && getFieldError('confirmPassword')" class="error">
          {{ getFieldError('confirmPassword') }}
        </div>
      </div>

      <div class="form-group">
        <div class="checkbox-container">
          <input
            type="checkbox"
            id="acceptTerms"
            formControlName="acceptTerms"
            [class.invalid]="acceptTerms?.invalid && acceptTerms?.touched"
          />
          <label for="acceptTerms" class="checkbox-label">
            Eu aceito os <a href="#" target="_blank">Termos de Uso</a> e a <a href="#" target="_blank">Política de Privacidade</a>
          </label>
        </div>
        <div *ngIf="acceptTerms?.touched && getFieldError('acceptTerms')" class="error">
          {{ getFieldError('acceptTerms') }}
        </div>
      </div>

      <button type="submit" [disabled]="!isFormValid() || isLoading" 
              class="register-btn" [class.loading]="isLoading">
        <span *ngIf="!isLoading">🚀 Criar Conta</span>
        <span *ngIf="isLoading">⏳ Criando conta...</span>
      </button>
    </form>

    <div *ngIf="errorMessage" class="error-message">
      {{ errorMessage }}
    </div>

    <div *ngIf="successMessage" class="success-message">
      {{ successMessage }}
    </div>

    <div class="login-link">
      <p>{{ getTranslation('register.haveAccount') }} <a routerLink="/login">{{ getTranslation('register.login') }}</a></p>
    </div>
  </div>
</div>
